<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Blogue do Caloni - C Resolve Tudo: Orientação a Objetos (com Polimorfismo)</title>
  <meta name="author" content="" />
  <meta name="description"
        content="Como programadores há um vício em nossas cabeças que é estar constantemente buscando a bala de prata, ou seja, a solução final e única para todos os nossos problemas de implementação. Com o tempo e..."/>

  <meta name="generator" content="Hugo 0.67.1" />

  
  <meta itemprop="name" content="C Resolve Tudo: Orientação a Objetos (com Polimorfismo)"/>
  <meta itemprop="description"
        content="Como programadores há um vício em nossas cabeças que é estar constantemente buscando a bala de prata, ou seja, a solução final e única para todos os nossos problemas de implementação. Com o tempo e..."/>
  <meta itemprop="image"
        content=""/>

  
  <meta property="og:title" content="C Resolve Tudo: Orientação a Objetos (com Polimorfismo)"/>
  <meta property="og:type"
        content="article"/>
  <meta property="og:url" content="http://www.caloni.com.br/c-resolve-tudo/"/>
  <meta property="og:image"
        content=""/>
  <meta property="og:description"
        content="Como programadores há um vício em nossas cabeças que é estar constantemente buscando a bala de prata, ou seja, a solução final e única para todos os nossos problemas de implementação. Com o tempo e..."/>
  <meta property="og:site_name" content="Blogue do Caloni"/>
  <meta property="article:published_time"
        content="2019-05-17T00:00:00&#43;00:00"/>
  <meta property="article:section" content="post"/>

  
  
  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:site"
        content=""/>
  <meta name="twitter:title" content="C Resolve Tudo: Orientação a Objetos (com Polimorfismo)"/>
  <meta name="twitter:description"
        content="Como programadores há um vício em nossas cabeças que é estar constantemente buscando a bala de prata, ou seja, a solução final e única para todos os nossos problemas de implementação. Com o tempo e..."/>
  <meta name="twitter:creator"
        content=""/>
  <meta name="twitter:image:src"
        content="
                     /images/movies.png
                   "/>

  
  <link href="" rel="alternate" type="application/rss+xml"
        title="Blogue do Caloni"/>
  <link href="" rel="feed" type="application/rss+xml"
        title="Blogue do Caloni"/>

  
  <link rel="stylesheet" type="text/css" href="/css/capsule.min.css"/>
  
  <link rel="stylesheet" type="text/css" href="/css/custom.css"/>

  
  <script>
  
    
      <!-- Google Analytics -->
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-50557403-2', 'auto');
      ga('send', 'pageview');
    
  
  </script>
  <script src="/js/jquery.min.js"></script>
  <script src="/js/list.js"></script>

  
  <link rel="icon" href="/favicon.ico"/>
  </head>


  <body style="min-height:100vh;display:flex;flex-direction:column">

    <nav class="navbar has-shadow is-white"
     role="navigation" aria-label="main navigation">
  <div class="container">

    <div class="navbar-brand">
      <a class="navbar-item" title="Go to Home" href="/">
        <img alt="Brand" src="/brand.svg">
        <div class="title is-6">&nbsp;Blogue do Caloni</div>
      </a>

      
      <label class="button navbar-burger is-white" for="navbar-burger-state">
        <span></span>                               
        <span></span>
        <span></span>
      </label>
    </div>

    
    <input type="checkbox" id="navbar-burger-state"/>

    <div class="navbar-menu">
      <div class="navbar-end" style="padding: 10px;">
      <big><b>
       <a title="posts dessa categoria" href="/categories/blog">blog</a>  <a title="posts dessa categoria" href="/categories/cinema">cinema</a>  <a title="posts dessa categoria" href="/categories/code">code</a> 
       <a href="/caloni"><span class="icon"><i class="fa fa-user"></i></a> <a href="index.xml"><span class="icon"><i class="fa fa-rss"></i></a>
      </big></b>
      </div>
    </div>

  </div>
</nav>


      
      <div class="container">
        <p class="title">C Resolve Tudo: Orientação a Objetos (com Polimorfismo)</p>

        <p class="subtitle">
<i>

    <a href="https://github.com/Caloni/post/commits/master/c-resolve-tudo.md" title="History">
    2019-05-17
    </a>

<span class="icon"><i class="fa fa-clock-o"></span></i>6 </i>
 <span class="icon"><i class="fa fa-pencil"></i></span><a href="https://github.com/Caloni/post/blob/master/c-resolve-tudo.md" title="GitHub">1068</a>
</p>

        <div class="taglist">
            <i>Este ainda é um rascunho publicado prematuramente e está sujeito a mudanças substanciais.</i>

        </div>

        

        
          <div class="content">
            
              <p>Como programadores há um vício em nossas cabeças que é estar constantemente buscando a bala de prata, ou seja, a solução final e única para todos os nossos problemas de implementação. Com o tempo e alguma experiência descobrimos que tal coisa não existe, mas até lá nos encantamos com esse ou aquele framework, e claro, com essa ou aquela linguagem.</p>
<p>As linguagens que são criadas depois da revolução dos computadores pessoais querem facilitar a vida do programador médio embutindo soluções já testadas por programadores de verdade e evitando a todo custo que o código incorra em erros comuns. Além disso, há movimentos nas comunidades e no mercado que geram tendências que influenciam essas linguagens, o que explica design patterns, orientação a objetos, programação funcional, xp, scrum, devops e qualquer outra bala de prata que vá se solidificando.</p>
<p>Expliquei tudo isso para chegar no tema deste artigo: você pode fazer tudo isso usando linguagem C.</p>
<p>Mas aí você deve estar se perguntando: &ldquo;supor que uma linguagem resolve tudo não é estar defendendo também uma bala de prata?&quot;. A resposta é sim e não. Sim, é uma bala de prata se você pensar que pode fazer do zero sites e interfaces gráficas modernas em C puro. Mas a resposta também é não porque eu estou trabalhando em uma outra camada, aquela em que as soluções que ficam pra sempre são implementadas. Estou falando de pensar sempre na linguagem C quando estiver interessado no funcionamento das outras soluções.</p>
<p>Esse mindset propost tem como objetivo impedir que você pense que as outras soluções são mágicas porque se você consegue pensar em C ela é real. Se tem algo que a linguagem C não é esse algo é mágica. C é uma simples abstração de uma máquina virtual que se relaciona de maneira muito íntima com as implementações em assembly de várias arquiteturas. Mágica é algo que te impede de enxergar em que momento uma solução se encontra com o hardware. C nunca irá te impedir de fazer isso.</p>
<p>Dito isto, vamos analisar algumas balas de prata e entender como em C isso é implementado para revelar a mágica.</p>
<p>A Orientação a Objetos se divide em algumas features. Algumas não vale a pena falar aqui, como tratar tudo como objeto. C já faz isso através de structs. Você pode montar uma struct que possua métodos, inclusive, através de ponteiros para função. E esses métodos já são sobrecarregáveis e virtuais.</p>
<pre><code>struct MyClass
{
    int x, y;
    void (*method)(int);
};

void method(int x)
{
}

struct MyClass NewMyClass()
{
    struct MyClass ret = { 0, 0 };
    ret.method = &amp;method;
    return ret;
}

int main()
{
    struct MyClass obj = NewMyClass();
    obj.method(10);
}
</code></pre>
<p>A sobrecarga se torna algo trivial, bem documentada através dos nomes das funções que você está chamando. Tudo fica às claras, nada implícito, nada disse que me disse. Se eu chamo um método NewMyClass2 é óbvio que estou construindo uma segunda versão baseada na primeira, e posso inclusive comparar para ver se os métodos são originais ou sobrescritos com obj.method == &amp;method, por exemplo. Além disso, é possível realizar composições de tipos onde alguns métodos são sobrescritos enquanto outros são compostos por chamadas duplas, triplas. Não há qualquer limitação ao polimorfismo exceto o que você define.</p>
<pre><code>struct MyClass
{
    int x, y;
    void (*method)(int);
};

void method(int x)
{
}

struct MyClass NewMyClass()
{
    struct MyClass ret = { 0, 0 };
    ret.method = &amp;method;
    return ret;
}

void method2(int x)
{
}

struct MyClass NewMyClass2()
{
    struct MyClass ret = NewMyClass();
    ret.method = &amp;method2;
    return ret;
}

int main()
{
    struct MyClass obj = NewMyClass2();
    obj.method(10);
}
</code></pre>
<p>Os métodos são &ldquo;estáticos&rdquo; por default (não há contexto), o que aliás facilita programação funcional, mas você pode buscar contexto onde te interessa, passando como parâmetro toda a &ldquo;classe&rdquo;, seja por valor ou referência, ou passando até uma versão parcial dela. Há inúmeras maneiras de construir um objeto em C, pois ele não está restrito às regras de sintaxe da definição da linguagem, uma vez que é você que define. Além disso, como você deve ter percebido, para declarar tipos de structs é necessário o uso dessa palavra-chave, mas a linguagem C já possui um sistema de typedef para trocar convenientemente qualquer definição de tipo como um nome único.</p>
<pre><code>#include &lt;stdio.h&gt;

typedef struct SCalc
{
    int (*sum)(int, int);
    int (*mult)(struct SCalc*, int, int);

} Calc;

int calc_sum(int x, int y)
{
    return x + y;
}

int calc_mult(Calc* calc, int x, int y)
{
    int ret = 0;
    int i;
    for( i = 0; i &lt; x; ++i )
        ret = calc-&gt;sum(ret, y);
    return ret;
}

Calc CalcNew()
{
    Calc calc;
    calc.sum = &amp;calc_sum;
    calc.mult = &amp;calc_mult;
    return calc;
}

int main()
{
    Calc calc = CalcNew();
    int x = 10, y = 32;
    int z = calc.sum(x, y);
    int k = calc.mult(&amp;calc, z, y);
    printf(&quot;%d + %d = %d, %d * %d = %d\n&quot;, x, y, z, z, y, k);
}

10 + 32 = 42, 42 * 32 = 1344
</code></pre>
<p>Note que podemos ao redefinir a função de soma a de multiplicação também é alterada, mesmo não alterando seu funcionamento (mas alterando uma função que ela usa).</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

typedef struct SCalc
{
    int (*sum)(int, int);
    int (*mult)(struct SCalc*, int, int);

} Calc;

int calc_sum(int x, int y)
{
    return x + y;
}

int calc_mult(Calc* calc, int x, int y)
{
    int ret = 0;
    int i;
    for( i = 0; i &lt; x; ++i )
        ret = calc-&gt;sum(ret, y);
    return ret;
}

Calc CalcNew()
{
    Calc calc;
    calc.sum = &amp;calc_sum;
    calc.mult = &amp;calc_mult;
    return calc;
}


int calc_cat(int x, int y)
{
    char buf[100];
    int ret;
    sprintf(buf, &quot;%d%d&quot;, x, y);
    ret = atoi(buf);
    return ret;
}

Calc BizarreCalcNew()
{
    Calc calc = CalcNew();
    calc.sum = &amp;calc_cat;
    return calc;
}

int main()
{
    Calc calc = BizarreCalcNew();
    int x = 1, y = 1;
    int z = calc.sum(x, y);
    int k = calc.mult(&amp;calc, z, y);
    printf(&quot;%d + %d = %d, %d * %d = %d\n&quot;, x, y, z, z, y, k);
}

10 + 32 = 1032, 1032 * 32 = 2147483647
</code></pre>
<p>Este é apenas um exemplo besta de polimorfismo, além de um exemplo trivial de como OO em C é infinitamente mais rico e mais complexo. Está nas mãos do programador definir até onde vai a solução proposta. E é bom saber que não existe bala de prata.</p>

            

          </div>

        <div class="taglist">
            
    
      <a href="/categories/code">code</a> 
      <a href="/tags/draft">draft</a> 
    
    <a href="https://twitter.com/intent/tweet?text=Como%20programadores%20h%c3%a1%20um%20v%c3%adcio%20em%20nossas%20cabe%c3%a7as%20que%20%c3%a9%20estar%20constantemente%20buscando%20a%20bala%20de%20prata%2c%20ou%20seja%2c%20a%20solu%c3%a7%c3%a3o...%20http%3a%2f%2fwww.caloni.com.br%2fc-resolve-tudo%2f from @caloni " style="text-decoration: underline;" title="Twitter">twitter</big></a>


        </div>

        <div class="navigation-bottom">
            <span style="float: right;"><a href="http://www.caloni.com.br/c-resolve-tudo-clos/">C Resolve Tudo Clos<span class="icon"><i class="fa fa-arrow-right"></i></span></a></span>
<span style="float: left;"><a href="http://www.caloni.com.br/o-demonio-das-onze-horas/"><span class="icon"><i class="fa fa-arrow-left"></i></span>O Demônio das Onze Horas</a></span>

        </div>

      </div>

    <footer class="footer">
  <div class="container">
    <span style="float: right;"><i style="font-size: small;">Blogue do Caloni 2020. Copyright é invenção do capitalismo burguês opressor. Todos os direitos não serão reservados.</i></span>
  </div>
</footer>

  </body>

</html>
