<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">

  
  
      
  
      
  

  <head>
  <meta charset="utf-8" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Blogue do Caloni - Como fazer merge de projetos distintos no Bazaar</title>
  <meta name="author" content="" />

  <meta name="generator" content="Hugo 0.67.1" />

  
  <meta property="og:title" content="Como fazer merge de projetos distintos no Bazaar"/>
  <meta property="og:type"
        content="article"/>
  <meta property="og:url" content="http://www.caloni.com.br/como-fazer-merge-de-projetos-distintos-no-bazaar/"/>
  <meta property="og:image"
        content="/img/author.jpg"/>
  <meta property="og:description"
        content="O problema foi o seguinte: Nós iniciamos o controle de fonte pelo Bazaar na parte Linux do projeto, já que ela não iria funcionar pelo Source Safe, mesmo. Dessa forma apenas um braço do projeto estava..."/>

  
  <link href="" rel="feed" type="application/rss+xml"
        title="Blogue do Caloni"/>

  
  
  <link rel="stylesheet" type="text/css" href="/css/custom.css"/>

  
  <script>
  
    
      <!-- Google Analytics -->
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-50557403-2', 'auto');
      ga('send', 'pageview');
    
  
  </script>
  <script src="/js/jquery.min.js"></script>
  <script src="/js/list.js"></script>

  
  <link rel="icon" href="/img/favicon.ico"/>
  </head>


  <body style="min-height:100vh;display:flex;flex-direction:column">

    <nav class="navbar has-shadow is-white"
     role="navigation" aria-label="main navigation">

  <div class="container">

    <div class="navbar-brand">
        <img alt="Brand" src="/img/brand.svg">
        &nbsp;
        <a class="navbar-item" title="Go to Home" href="/">
            <div class="is-6">Blogue do Caloni</div>
        </a>
    </div>

    

  </div>
</nav>


      
      <div class="container">
        <p class="title">

Como fazer merge de projetos distintos no Bazaar

</p>

        

        
          <div class="content">

            
              <p>O problema foi o seguinte: Nós iniciamos o controle de fonte pelo <a href="http://bazaar-vcs.org/">Bazaar</a> na parte Linux do projeto, já que ela não iria funcionar pelo <a href="http://www.caloni.com.br/blog/guia-basico-de-controle-de-codigo-source-safe">Source Safe</a>, mesmo. Dessa forma apenas um braço do projeto estava no controle de fonte e o resto não.</p>
<p>No segundo momento da evolução decidimos começar a migrar os projetos para o Bazaar, inclusive a parte daquele projeto que compila no Windows. Maravilha. Ambos sendo controlados é uma beleza, não é mesmo?</p>
<p>Até que veio o dia de juntar.</p>
<p>O processo de _merge _de um controle de fonte supõe que os _branches _começaram em algum <strong>ponto em comum</strong>; do contrário não há como o controlador saber as coisas que mudaram em paralelo. Pois é achando a modificação <strong>ancestral</strong>, pai de ambos os <em>branches</em>, que ele irá medir a dificuldade de juntar as versões novamente. Se não existe ancestral, não existe análise. Como exemplificado na figura:</p>
<p><a href="/images/branches-sem-ancestral.gif"><img src="http://i.imgur.com/HfJy8hP.gif" alt="branches-sem-ancestral.gif"></a></p>
<h4 id="se-baseando-no-rebase">Se baseando no rebase</h4>
<p>Acontece que existe um _plugin _esperto que consegue migrar revisões (<em>commits</em>) entre _branches _sem qualquer parentesco. Não me pergunte como ele faz isso. Mas ele faz. E foi assim que resolvemos o problema dos _branches _órfãos.</p>
<p>Para instalar o _plugin _do <strong>rebase</strong>, basta <a href="http://bazaar-vcs.org/Rebase">baixá-lo e</a> copiar sua pasta extraída com um nome válido no Python (rebase, por exemplo). A partir daí os comandos do _plugin _estão disponíveis no _prompt _do Bazaar, assim como a instalação de qualquer _plugin _que cria novos comandos.</p>
<pre><code>&gt;bzr help commands
add             Add specified files or directories.
annotate        Show the origin of each line in a file.
bind            Convert the current branch into a checkout of the supplied branch.
branch          Create a new copy of a branch.
...
push            Update a mirror of this branch.
&lt;font color=&quot;#ff0000&quot;&gt;rebase          Re-base a branch. [rebase]
rebase-abort    Abort an interrupted rebase [rebase]
rebase-continue Continue an interrupted rebase after resolving conflicts [rebase]
rebase-todo     Print list of revisions that still need to be replayed as part of the  [rebase]
&lt;/font&gt;reconcile       Reconcile bzr metadata in a branch.
reconfigure     Reconfigure the type of a bzr directory.
register-branch Register a branch with launchpad.net. [launchpad]
remerge         Redo a merge.
remove          Remove files or directories.
remove-tree     Remove the working tree from a given branch/checkout.
renames         Show list of renamed files.
&lt;font color=&quot;#ff0000&quot;&gt;replay          Replay commits from another branch on top of this one. [rebase]
&lt;/font&gt;resolve         Mark a conflict as resolved.
revert          Revert files to a previous revision.
...
whoami          Show or set bzr user id.
</code></pre>
<h4 id="fica-de-olho-no-replay">Fica de olho no replay!</h4>
<p>O comando que usamos foi o <strong>replay</strong>, que não é comando principal do _plugin, _mas que resolve esse problema de maneira quase satisfatória. Como era tudo o que tínhamos, valeu a pena.</p>
<p>O processo que usei foi de usar esse comando n vezes para buscar revisões de um branch e colocar no outro. Um grande problema com ele é que ao encontrar merges no branch origem ele se perde e o usuário tem que fazer as modificações &quot;na mão&quot;. Deu um pouco de trabalho, mas conseguimos migrar nossos _commits _mais importantes e deixar o projeto inteiro, Linux+Windows, em um _branch _só.</p>
<pre><code>C:\Tests&gt;bzr init linux

C:\Tests&gt;cd linux

C:\Tests\linux&gt;copy con lnx
linux
^Z
        1 arquivo(s) copiado(s).

C:\Tests\linux&gt;bzr add
added lnx

C:\Tests\linux&gt;bzr commit -m &quot;Linux 1&quot;
Committing to: C:/Tests/linux/
added lnx
Committed revision 1.

C:\Tests\linux&gt;copy con lnx2
linux2
^Z
        1 arquivo(s) copiado(s).

C:\Tests\linux&gt;bzr add
added lnx2

C:\Tests\linux&gt;bzr commit -m &quot;Linux 2&quot;
Committing to: C:/Tests/linux/
added lnx2
Committed revision 2.

C:\Tests\linux&gt;cd ..

C:\Tests&gt;bzr init windows

C:\Tests&gt;cd windows

C:\Tests\windows&gt;copy con win1
windows
^Z
        1 arquivo(s) copiado(s).

C:\Tests\windows&gt;bzr add
added win1

C:\Tests\windows&gt;bzr commit -m &quot;Windows 1&quot;
Committing to: C:/Tests/windows/
added win1
Committed revision 1.

C:\Tests\windows&gt;copy con win2
windows2
^Z
        1 arquivo(s) copiado(s).
C:\Tests\windows&gt;bzr add
added win2

C:\Tests\windows&gt;bzr commit -m &quot;Windows 2&quot;
Committing to: C:/Tests/windows/
added win2
Committed revision 2.

C:\Tests\linux&gt;cd ..

C:\Tests&gt;cd linux

C:\Tests\linux&gt;bzr replay ..\windows -r1..2
All changes applied successfully.
Committing to: C:/Tests/linux/
added win1
Committed revision 3.
All changes applied successfully.
Committing to: C:/Tests/linux/
added win2
Committed revision 4.


C:\Tests\linux&gt;bzr log
------------------------------------------------------------
revno: 4
committer: Wanderley Caloni &lt;wanderley@caloni.com.br&gt;
branch nick: windows
timestamp: Mon 2008-06-16 07:17:10 -0300
message:
  Windows 2
------------------------------------------------------------
revno: 3
committer: Wanderley Caloni &lt;wanderley@caloni.com.br&gt;
branch nick: windows
timestamp: Mon 2008-06-16 07:16:52 -0300
message:
  Windows 1
------------------------------------------------------------
revno: 2
committer: Wanderley Caloni &lt;wanderley@caloni.com.br&gt;
branch nick: linux
timestamp: Mon 2008-06-16 07:16:24 -0300
message:
  Linux 2
------------------------------------------------------------
revno: 1
committer: Wanderley Caloni &lt;wanderley@caloni.com.br&gt;
branch nick: linux
timestamp: Mon 2008-06-16 07:16:01 -0300
message:
  Linux 1

C:\Tests\linux&gt;ls
lnx  lnx2  win1  win2

C:\Tests\linux&gt;
</code></pre>
<p><img src="http://i.imgur.com/3X8DCfS.gif" alt="branches-com-replay.gif"></p>

            

          </div>

        <div class="taglist">
            <p class="author">

  Wanderley Caloni,
  
    
  
    
  
  <a href="https://github.com/Caloni/blog/blob/master/content/posts/como-fazer-merge-de-projetos-distintos-no-bazaar.md">2008-06-16</a>

</p>

            
      <a href="/categories/blog">blog</a> 
      <a href="/tags/draft">draft</a> 
    <a class="externalgray" href="https://telegram.me/share/url?url=http://www.caloni.com.br/como-fazer-merge-de-projetos-distintos-no-bazaar/">discuss</a>


        </div>

      </div>

  </body>

</html>
