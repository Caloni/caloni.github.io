<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">

  
  
      
  
      
  

  <head>
  <meta charset="utf-8" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Blogue do Caloni - Curiosidades inúteis: o operador de subscrito em C&#43;&#43;</title>
  <meta name="author" content="" />

  <meta name="generator" content="Hugo 0.67.1" />

  
  <meta property="og:title" content="Curiosidades inúteis: o operador de subscrito em C&#43;&#43;"/>
  <meta property="og:type"
        content="article"/>
  <meta property="og:url" content="http://www.caloni.com.br/curiosidades-inuteis-o-operador-de-subscrito-em-c/"/>
  <meta property="og:image"
        content="/img/author.jpg"/>
  <meta property="og:description"
        content="
Em C e C&#43;&#43; as regras de sintaxe são extremamente flexíveis. Essa liberdade toda se manteve no decorrer dos tempos porque se trata de uma das idéias fundamentais da linguagem C, motivo de sua criação....&lt;/!--&gt;"/>

  
  <link href="" rel="feed" type="application/rss+xml"
        title="Blogue do Caloni"/>

  
  
  <link rel="stylesheet" type="text/css" href="/css/custom.css"/>

  
  <script>
  
    
      <!-- Google Analytics -->
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-50557403-2', 'auto');
      ga('send', 'pageview');
    
  
  </script>
  <script src="/js/jquery.min.js"></script>
  <script src="/js/list.js"></script>

  
  <link rel="icon" href="/img/favicon.ico"/>
  </head>


  <body style="min-height:100vh;display:flex;flex-direction:column">

    <nav class="navbar has-shadow is-white"
     role="navigation" aria-label="main navigation">

  <div class="container">

    <div class="navbar-brand">
        <img alt="Brand" src="/img/brand.svg">
        &nbsp;
        <a class="navbar-item" title="Go to Home" href="/">
            <div class="is-6">Blogue do Caloni</div>
        </a>
    </div>

    

  </div>
</nav>


      
      <div class="container">
        <p class="title">

Curiosidades inúteis: o operador de subscrito em C&#43;&#43;

</p>

        <p class="subtitle">

  Wanderley Caloni,
  
    
  
    
  
  2007-12-27<a href="https://github.com/Caloni/blog/blob/master/content/posts/curiosidades-inuteis-o-operador-de-subscrito-em-c.md">.</a>

</p>

        

        
          <div class="content">

            
              <!-- raw HTML omitted -->
<p>Em C e C++ as regras de sintaxe são extremamente flexíveis. Essa liberdade toda se manteve no decorrer dos tempos porque se trata de uma das idéias fundamentais da linguagem C, motivo de sua criação. Me lembro certa vez que, bitolado em C Standard 89, usei uma sintaxe não lá muito usual para acessar um elemento de um <em>array</em>. Foi apenas um experimento de estudante, coisa que nunca vi em código algum e queria comprovar.</p>
<h4 id="a-regra-para-acessar-_arrays_-é-não-existem-_arrays_">A regra para acessar <em>arrays</em> é: não existem <em>arrays</em></h4>
<p>As regras de acesso a elementos de um <em>array</em> (subscrito) são definidas não em termos do <em>array</em>, mas em termos de um ponteiro e de um índice. &quot;Me dê um ponteiro para T e um inteiro e te retorno um <em>lvalue</em> do tipo T&quot;. Essa é a idéia geral. A mesma idéia, com pequenas alterações, se manteve em C++. Eis parte do parágrafo que fala sobre isso:</p>
<!-- raw HTML omitted -->
<blockquote>
<p><em>A postfix expression followed by an expression in square brackets is a postfix expression. One of the expressions shall have the type &quot;pointer to T&quot; and the other shall have enumeration or integral type. The result is an lvalue of type &quot;T&quot;. (...) The expression E1 [ E2 ] is identical (by definition) to *( (E1) + (E2) ).</em></p>
</blockquote>
<blockquote>
<p><strong>C++: International Standard ISO/IEC 14882 First Edition 1998-09-01</strong></p>
</blockquote>
<!-- raw HTML omitted -->
<p>Isso traduzido em miúdos quer dizer que com duas expressões formando a construção <strong>E1 [ E2 ]</strong>, sendo uma delas do tipo <strong>ponteiro para um tipo</strong> e a outra do tipo <strong>integral</strong>, o resultado é equivalente a *<strong>( (E1) + (E2) )</strong>. Como no código abaixo:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
{
	<span style="color:#66d9ef">char</span> ditado[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Diga-me com que programas e eu te direi quem és.&#34;</span>;
	<span style="color:#66d9ef">int</span> indice <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>;

	std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;E a linguagem é: &#34;</span> <span style="color:#f92672">&lt;&lt;</span> ditado[indice] <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
} 

</code></pre></div><p>A teoria comprovada na prática: temos duas expressões no formato E1 [ E2 ] sendo uma do tipo <strong>ponteiro para char</strong> e a outra do tipo <strong>int</strong>, exatamente como a regra define. O detalhe obscuro que permaneceu durante a evolução dessas duas linguagens é que a regra de acesso a elementos <strong>não define a ordem das expressões</strong>. Assim sendo, me aproveito dessa flexibilidade e inverto os elementos do subscrito:</p>
<pre><code>   std::cout &lt;&lt; &lt;span class=&quot;string&quot;&gt;&quot;E a linguagem é: &quot;&lt;/span&gt; &lt;&lt; indice[ditado] &lt;&lt; std::endl;
</code></pre>
<p>Isso também compila e tem o mesmo resultado, pois também é equivalente a *( (E1) + (E2) ). No final dá na mesma. E do jeito que está a inversão nem dá tanto susto assim, pois estamos lidando com duas variáveis. A coisa começa a ficar mais <a href="http://www.ioccc.org/">IOCCC</a> se colocarmos em vez de uma delas uma constante:</p>
<pre><code>   std::cout &lt;&lt; &lt;span class=&quot;string&quot;&gt;&quot;E a linguagem é: &quot;&lt;/span&gt; &lt;&lt; 8[ditado] &lt;&lt; std::endl;
</code></pre>
<p>Isso ainda é válido, certo? Os tipos das expressões estão de acordo com a regra. Fica simples de visualizar se sempre pensarmos no &quot;equivalente universal&quot; *( (E1) + (E2) ). Até coisas bizarras como essa acabam ficando simples:</p>
<pre><code>   std::cout &lt;&lt; 5[&lt;span class=&quot;string&quot;&gt;&quot;Isso Compila?&quot;&lt;/span&gt;] &lt;&lt; std::endl;
</code></pre>
<p><em>Nota do autor: esse tipo de &quot;recurso obscuro&quot; dificilmente passará por uma revisão de código, e com razão, dado que não é um método útil e muito menos conhecido. Sábio é saber evitar. Não acredito, porém, que o conhecimento de certos detalhes da linguagem em que se programa sejam completamente inúteis. Conhecimento nunca é demais, pois quanto mais se conhece maior é o número de ferramentas conceituais que se dispõe para resolver um certo problema. Em muitas vezes o &quot;conhecimento inútil&quot; de hoje se torna um guia sábio quando se precisa de bons conceitos sobre a coisa toda. No entanto, que não venha um <a href="http://www.google.com.br/search?q=boi+corneta+site%3Asualingua.com.br">boi-corneta</a> me dizer que esse código fere as boas práticas de programação. Tenho dito.</em></p>

            

          </div>

        <div class="taglist">
            
    
      <a href="/tags/draft">draft</a>  <a href="/tags/code">code</a> 
    <a class="externalgray" href="https://telegram.me/share/url?url=http://www.caloni.com.br/curiosidades-inuteis-o-operador-de-subscrito-em-c/">discuss</a>


        </div>

        <div class="navigation-bottom">
            <span class="next-in-section"><a href="http://www.caloni.com.br/gambi-do-dia-swap-com-apenas-duas-variaveis/">&#x25C1; Gambi do dia: swap com apenas duas variáveis</a></span>
<span class="prev-in-section"><a href="http://www.caloni.com.br/o-que-acontece-quando-o-contador-estoura/">&#x25B7; O que acontece quando o contador estoura</a></span>

        </div>

      </div>

    <footer class="footer">
  <div class="container">
    <span style="float: right;"><i style="font-size: small;">Blogue do Caloni 2021<a href="https://github.com/Caloni/blog">.</a> </i></span>
  </div>
</footer>

  </body>

</html>
