<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">

  
  
      
  
      
  

  <head>
  <meta charset="utf-8" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Blogue do Caloni - Gabaritos</title>
  <meta name="author" content="" />

  <meta name="generator" content="Hugo 0.67.1" />

  
  <meta property="og:title" content="Gabaritos"/>
  <meta property="og:type"
        content="article"/>
  <meta property="og:url" content="http://www.caloni.com.br/gabaritos/"/>
  <meta property="og:image"
        content="/img/author.jpg"/>
  <meta property="og:description"
        content="Um template -- ou, como é na tradução da primeira edição de The C&#43;&#43; Programming Language, de Bjarne Stroustrup, aqui no Brasil: gabarito -- é um molde que pode ser usado por diferentes tipos para..."/>

  
  <link href="" rel="feed" type="application/rss+xml"
        title="Blogue do Caloni"/>

  
  
  <link rel="stylesheet" type="text/css" href="/css/custom.css"/>

  
  <script>
  
    
      <!-- Google Analytics -->
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-50557403-2', 'auto');
      ga('send', 'pageview');
    
  
  </script>
  <script src="/js/jquery.min.js"></script>
  <script src="/js/list.js"></script>

  
  <link rel="icon" href="/img/favicon.ico"/>
  </head>


  <body style="min-height:100vh;display:flex;flex-direction:column">

    <nav class="navbar has-shadow is-white"
     role="navigation" aria-label="main navigation">

  <div class="container">

    <div class="navbar-brand">
        <img alt="Brand" src="/img/brand.svg">
        &nbsp;
        <a class="navbar-item" title="Go to Home" href="/">
            <div class="is-6">Blogue do Caloni</div>
        </a>
    </div>

    

  </div>
</nav>


      
      <div class="container">
        <p class="title">

Gabaritos

</p>

        <p class="subtitle">

  Wanderley Caloni,
  
    
  
    
  
  <a href="https://github.com/Caloni/blog/blob/master/content/posts/gabaritos.md">2016-01-13</a>

</p>

        

        
          <div class="content">

            
              <p>Um <strong>template</strong> -- ou, como é na tradução da primeira edição de The C++ Programming Language, de Bjarne Stroustrup, aqui no Brasil: <strong>gabarito</strong> -- é um molde que pode ser usado por diferentes tipos para traduzir o mesmo algoritmo, ou pelo menos a mesma intenção de algoritmo (por pela sobrecarga de operadores é possível que o comportamento de tipos diferentes pode ser diferente).</p>
<p>Em C++, fazer uma função template é muito simples:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;

<span style="color:#66d9ef">template</span><span style="color:#f92672">&lt;</span><span style="color:#66d9ef">typename</span> T<span style="color:#f92672">&gt;</span>
<span style="color:#66d9ef">bool</span> Compare(T<span style="color:#f92672">&amp;</span> var1, T<span style="color:#f92672">&amp;</span> var2)
{
	<span style="color:#66d9ef">return</span> var1 <span style="color:#f92672">&lt;</span> var2;
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
{
	<span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> <span style="color:#ae81ff">24</span>, y <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>;
	<span style="color:#66d9ef">double</span> dx <span style="color:#f92672">=</span> <span style="color:#ae81ff">100.0</span>, dy <span style="color:#f92672">=</span> <span style="color:#ae81ff">10.0</span>;

	cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;x is &#34;</span> <span style="color:#f92672">&lt;&lt;</span> ( Compare(x, y) <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;lesser&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bigger&#34;</span> ) <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; than y</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
	cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;dx is &#34;</span> <span style="color:#f92672">&lt;&lt;</span> ( Compare(dx, dy) <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;lesser&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bigger&#34;</span> ) <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; than dy</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
}
</code></pre></div><p><img src="http://i.imgur.com/84Ptrvk.png" alt=""></p>
<p>Continuando nosso tema de fazer as mesmas coisas em C, <strong>templates</strong> não é tão simples, pois não existe de fato na linguagem. Templates são interpretados pelo compilador, que gera um esqueleto de algoritmo que é usado para preencher código de todos os tipos utilizados. Em C isso era feito usando macros. Porém, macros não fazem parte da linguagem C. É apenas uma ferramenta chamada pré-processador que substitui texto antes do programa ser compilado. É através do pré-processador que, por exemplo, os headers são incluídos em um código-fonte. Isso já foi explicado em um <a href="/os-diferentes-erros-na-linguagem-c">artigo</a> bem velhinho, e mais recentemente em uma <a href="/entendendo-a-compilacao">palestra</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">// qual o tipo de x e y? qualquer um que faça comparação
</span><span style="color:#75715e"></span><span style="color:#75715e">#define MACRO(x, y) x &lt; y
</span></code></pre></div><p>Eu não recomendaria usar macros em C++, assim como não recomendo em C. Porém, em C é a única opção para reciclar algoritmos de maneira estática. Exceto se você usar ponteiros de função, o que adiciona pouco overhead, mas se perde, assim como a técnica de macro, a informação dos tipos. A própria libc contém uma função, <a href="http://www.cplusplus.com/reference/cstdlib/qsort/"><strong>qsort</strong></a>, que é &quot;genérica&quot; através do uso de ponteiros sem tipo (void*) e ponteiro de função. A função ordena elementos de uma lista, mas para isso depende da função de comparação que é passada por parâmetro. Essa função recebe dois void* que deve comparar. Além disso, o leiaute na memória tem que ser fixo, contínuo, pois é assim que a função consegue mover os elementos. Ou seja, bem limitado.</p>
<p><img src="http://i.imgur.com/3TkGFkN.png" alt=""></p>
<p>Dessa forma, não pretendo ensinar a usar &quot;templates&quot; em C, mas a usá-los em C++ com foco em C. Um amigo conhecido de vocês, o <a href="http://driverentry.com.br/">Fernando/DriverEntry</a>, utilizou essa técnica com maestria em alguns códigos kernel-mode que ele desenvolveu, e é uma maneira válida de se aproveitar de uma linguagem mais &quot;alto nível&quot; como C++ em ambientes limitados como o código que trabalha com o S.O.. Como a API do kernel lida com abstrações em C, seus objetos necessariamente não são objetos no sentido C++, mas os famigerados &quot;ponteiros opacos&quot;.</p>
<p>Mais sobre isso em um próximo post.</p>

            

          </div>

        <div class="taglist">
            
    
      <a href="/tags/draft">draft</a>  <a href="/tags/code">code</a> 
    <a class="externalgray" href="https://telegram.me/share/url?url=http://www.caloni.com.br/gabaritos/">discuss</a>


        </div>

        <div class="navigation-bottom">
            <span class="next-in-section"><a href="http://www.caloni.com.br/expresso-do-amanha/">&#x25C1; Expresso do Amanhã</a></span>
<span class="prev-in-section"><a href="http://www.caloni.com.br/classe-objeto-contexto-metodo-polimorfismo/">&#x25B7; Classe, objeto, contexto, método, polimorfismo</a></span>

        </div>

      </div>

    <footer class="footer">
  <div class="container">
    <span style="float: right;"><i style="font-size: small;">Blogue do Caloni <a href="https://github.com/Caloni/blog">2021.04.09</a> </i></span>
  </div>
</footer>

  </body>

</html>
